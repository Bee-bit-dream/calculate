<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°ìì™€ í˜¸ë°• ì‚°ì¶œê¸°</title>
    <style>
        #record {
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
            border: 1px solid #ccc;
            padding: 10px;
            margin-top: 10px;
        }
        .toggle-button {
            cursor: pointer;
            color: blue;
            text-decoration: underline;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
    <script>
        let records = JSON.parse(localStorage.getItem("records")) || []; // Local Storageì—ì„œ ê¸°ë¡ ë¶ˆëŸ¬ì˜¤ê¸°

        function toggleRecord() {
            const recordDiv = document.getElementById("record");
            recordDiv.style.display = recordDiv.style.display === "none" ? "block" : "none";
        }

        function updateOptions() {
            const item = document.getElementById("item").value;
            const waterSelect = document.getElementById("water");
            const weedSelect = document.getElementById("weed");

            // ì„ íƒ í•­ëª©ì— ë”°ë¼ ë¬¼ì£¼ê¸°ì™€ ì¡ì´ˆë½‘ê¸° ì˜µì…˜ ì—…ë°ì´íŠ¸
            if (item === "ê°ì") {
                updateSelect(waterSelect, 5);
                updateSelect(weedSelect, 5);
            } else if (item === "í˜¸ë°•") {
                updateSelect(waterSelect, 7);
                updateSelect(weedSelect, 7);
            }
        }

        function updateSelect(selectElement, max) {
            selectElement.innerHTML = ""; // ê¸°ì¡´ ì˜µì…˜ ì œê±°
            for (let i = 0; i <= max; i++) {
                let option = document.createElement("option");
                option.value = i;
                option.text = i;
                selectElement.add(option);
            }
        }

        function calculate() {
            const item = document.getElementById("item").value;
            const waterCount = parseInt(document.getElementById("water").value);
            const weedCount = parseInt(document.getElementById("weed").value);
            const playerName = document.getElementById("player").value;
            const creatorName = document.getElementById("creator").value;

            // ëœë¤ ê°’ ê³„ì‚°
            let waterSum = 0;
            const waterValues = [];
            for (let i = 0; i < waterCount; i++) {
                const value = Math.floor(Math.random() * 30) + 1;
                waterSum += value;
                waterValues.push(value); // ëœë¤ ê°’ì„ ì €ì¥
            }

            let weedSum = 0;
            const weedValues = [];
            for (let i = 0; i < weedCount; i++) {
                const value = Math.floor(Math.random() * 11) + 5;
                weedSum += value;
                weedValues.push(value); // ëœë¤ ê°’ì„ ì €ì¥
            }

            const total = waterSum + weedSum;

            // í˜„ì¬ ë‚ ì§œ ë° ì‹œê°„ ê°€ì ¸ì˜¤ê¸°
            const now = new Date();
            const dateTime = now.toLocaleString(); // "YYYY/MM/DD HH:MM:SS" í˜•ì‹

            // ê°„ë‹¨í•œ ê²°ê´ê°’ ì¶œë ¥
            document.getElementById("result").innerText = `ë¬¼ì£¼ê¸° í•©ê³„: ${waterSum}, ì¡ì´ˆë½‘ê¸° í•©ê³„: ${weedSum}`;
            
            // ğŸŒŸ ê²°ê³¼ ê³„ì‚°
            let stars = "ğŸŒŸ";
            if (total > 200) {
                stars = "ğŸŒŸğŸŒŸğŸŒŸ";
            } else if (total > 100) {
                stars = "ğŸŒŸğŸŒŸ";
            }
            document.getElementById("finalResult").innerText = `ê²°ê³¼: ${stars}`;

            // ì‚°ì¶œ ê¸°ë¡ ì €ì¥
            const record = { dateTime, creator: creatorName, player: playerName, item, waterSum, weedSum, total, stars, waterValues, weedValues };
            records.push(record);
            localStorage.setItem("records", JSON.stringify(records)); // Local Storageì— ê¸°ë¡ ì €ì¥
            updateRecordDisplay();
        }

        function updateRecordDisplay() {
            const recordDiv = document.getElementById("record");
            recordDiv.innerHTML = ""; // ê¸°ì¡´ ê¸°ë¡ ì œê±°

            // í‘œ ìƒì„±
            const table = document.createElement("table");
            const headerRow = document.createElement("tr");
            headerRow.innerHTML = "<th>ë‚ ì§œ ë° ì‹œê°„</th><th>ì‚°ì¶œì</th><th>í”Œë ˆì´ì–´</th><th>ì‘ë¬¼</th><th>ë¬¼ì£¼ê¸° í•©ê³„</th><th>ì¡ì´ˆë½‘ê¸° í•©ê³„</th><th>ì´í•©</th><th>ê²°ê³¼</th><th>ë¬¼ì£¼ê¸° ê°’</th><th>ì¡ì´ˆë½‘ê¸° ê°’</th>";
            table.appendChild(headerRow);

            records.forEach(record => {
                const row = document.createElement("tr");
                row.innerHTML = `<td>${record.dateTime}</td><td>${record.creator}</td><td>${record.player}</td><td>${record.item}</td><td>${record.waterSum}</td><td>${record.weedSum}</td><td>${record.total}</td><td>${record.stars}</td><td>${record.waterValues.join(", ")}</td><td>${record.weedValues.join(", ")}</td>`;
                table.appendChild(row);
            });

            recordDiv.appendChild(table);
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë¡ê³¼ ê¸°ë³¸ ì„ íƒ í•­ëª© ì—…ë°ì´íŠ¸
        window.onload = function() {
            updateRecordDisplay(); // ì €ì¥ëœ ê¸°ë¡ í‘œì‹œ
            updateOptions(); // ê¸°ë³¸ ì„ íƒ í•­ëª© ì—…ë°ì´íŠ¸
        };
    </script>
</head>
<body>
    <h1>ê°ìì™€ í˜¸ë°• ì‚°ì¶œê¸°</h1>

    <label for="creator">ì‚°ì¶œì:</label>
    <input type="text" id="creator" placeholder="ì‚°ì¶œì ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
    <br><br>

    <label for="player">í”Œë ˆì´ì–´:</label>
    <input type="text" id="player" placeholder="í”Œë ˆì´ì–´ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
    <br><br>

    <label for="item">ì‘ë¬¼ ì„ íƒ:</label>
    <select id="item" onchange="updateOptions()">
        <option value="ê°ì">ê°ì</option>
        <option value="í˜¸ë°•">í˜¸ë°•</option>
    </select>
    <br><br>

    <label for="water">ë¬¼ì£¼ê¸° íšŸìˆ˜ ì„ íƒ:</label>
    <select id="water">
        <!-- ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ë¹„ì›Œë‘  -->
    </select>
    <br><br>

    <label for="weed">ì¡ì´ˆë½‘ê¸° íšŸìˆ˜ ì„ íƒ:</label>
    <select id="weed">
        <!-- ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ë¹„ì›Œë‘  -->
    </select>
    <br><br>

    <button onclick="calculate()">ê²°ê³¼ ê³„ì‚°</button>
    <br><br>

    <h3 id="result"></h3>
    <h3 id="finalResult"></h3>

    <div>
        <span class="toggle-button" onclick="toggleRecord()">ì‚°ì¶œ ê¸°ë¡ ë³´ê¸°</span>
        <div id="record">
            <!-- ì‚°ì¶œ ê¸°ë¡ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
        </div>
    </div>
</body>
</html>
